{% extends "base.html" %}

{% block content %}
    <!-- navbar -->
    {% include "partials/navbar.html" %}

    <!-- main content -->
    <main class="flex-grow mt-5 mb-20 px-5 w-full max-w-4xl lg:max-w-6xl mx-auto">
        <!-- flash messages -->
        <div id="flash-messages" class="transition-all duration-300 mb-5">
            {% include "partials/flash_messages.html" %}
        </div>

        <!-- back button -->
        <div class="mb-2 text-sm font-medium text-gray-600 hover:cursor-pointer hover:text-gray-800 transition-colors">
            <button onclick="handleBack()" class="inline-flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                     class="lucide lucide-move-left-icon lucide-move-left">
                    <path d="M6 8L2 12L6 16"/>
                    <path d="M2 12H22"/>
                </svg>

                <span>Back</span>
            </button>
        </div>

        {% if opp_details %}
            <div class="bg-white rounded-2xl shadow-lg p-5 md:p-10 flex flex-col gap-10">
                <!-- image -->
                <div class="w-full">
                    <img
                            src="{{ opp_details.opp_image_url }}"
                            alt="{{ opp_details.title }}"
                            class="rounded-xl object-cover w-full h-80 md:max-h-200 shadow"
                    />
                </div>

                <!-- bottom content -->
                <div class="flex flex-col justify-between flex-1 space-y-6">
                    <!-- title -->
                    <h1 class="text-4xl font-bold">{{ opp_details.title }}</h1>

                    <!-- dates and category -->
                    <div class="flex flex-wrap items-center gap-3 text-gray-700 text-md">
                <span class="font-medium">
                    {{ opp_details.start_date }} {% if opp_details.end_date %} &mdash;
                    {{ opp_details.end_date }} {% endif %}
                </span>

                        <span
                                class="px-3 py-1 rounded-full bg-orange-200 text-gray-900 text-sm font-semibold"
                        >
                    {{ opp_details.category.replace("_", " ").title() }}
                </span>
                    </div>

                    <!-- description -->
                    <div class="text-gray-700 leading-relaxed text-lg">
                        {{ opp_details.description | safe }}
                    </div>

                    <!-- organizer -->
                    <div>
                        <a
                                href="{{ url_for('organization_details', org_id=opp_details.org_id) }}"
                                class="text-blue-600 hover:text-blue-800 font-medium underline"
                        >
                            Hosted by: {{ opp_details.org_name }}
                        </a>
                    </div>

                    <!-- signup button -->
                    <form
                            hx-post="{{ url_for("signup", opp_id=opp_details.opp_id) }}"
                            hx-target="#signup-btn-wrapper"
                            hx-swap="outerHTML"
                            class="pt-4"
                    >
                        <div id="signup-btn-wrapper">
                            <button
                                    id="signup-btn"
                                    type="submit"
                                    class="w-full md:w-auto flex gap-2 inline-flex items-center justify-center bg-utdOrange text-white text-lg font-semibold px-6 py-3 rounded-xl hover:cursor-pointer hover:bg-orange-500 transition shadow-md"
                                    hx-disable="true"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                     viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                     stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                     class="lucide lucide-pen-line">
                                    <path d="M13 21h8"/>
                                    <path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"/>
                                </svg>
                                <span>Sign Up</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        {% else %}
            <h3 class="font-lg text-gray-700 mt-10">This opportunity does not exist</h3>
        {% endif %}
    </main>
{% endblock content %}
